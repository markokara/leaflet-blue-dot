<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Dijital BroÅŸÃ¼r (SVG)</title>

<style>
  /* â€”â€”â€” Basit tema â€”â€”â€” */
  :root{--border:#cfe3da;--shadow:0 10px 28px rgba(0,0,0,.18);--brand:#0f5132}
  html,body{height:100%;margin:0;background:#0f3b2e;font:14px system-ui,color:#0b3a2d}

  /* Sahne: SVG + Ã¼stÃ¼ne oturan etkileÅŸim katmanÄ± (#hit) */
  #stage{position:fixed;inset:0}
  #plan{position:absolute;inset:0;width:100%;height:100%;border:0}

  /* #hit: SVGâ€™nin ekranda Ã§izildiÄŸi GERÃ‡EK alana JS ile tam oturtulacak.
     Bu sayede yÃ¼zdeler â€œtam noktasÄ±nÄ±â€ gÃ¶sterir, kenar boÅŸluklarÄ±ndan etkilenmez. */
  #hit{position:absolute}

  /* TÄ±klanabilir etiket (hotspot) â€” % left/top ile konumlandÄ±rÄ±lÄ±r */
  .hot{
    position:absolute; transform:translate(-50%,-100%);
    background:#fff; border:1px solid var(--border); border-radius:12px;
    box-shadow:var(--shadow); padding:6px 10px; cursor:pointer; font-weight:600;
    white-space:nowrap;
  }
  .hot small{display:block; opacity:.75}

  /* Popup kart */
  .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:50}
  .modal.on{display:flex}
  .back{position:absolute; inset:0; background:rgba(0,0,0,.45)}
  .card{
    position:relative; background:#fff; border:1px solid var(--border); border-radius:16px;
    box-shadow:var(--shadow); width:min(520px,92vw); padding:14px
  }
  .btn{padding:9px 12px; border:1px solid var(--border); border-radius:10px;
       background:#e6f4ef; color:var(--brand); font-weight:700; cursor:pointer}
  .muted{color:#5b6a6a; font-size:13px}

  /* ALT+tÄ±k Ã¶lÃ§Ã¼m yardÄ±mcÄ±sÄ± (gÃ¶rsel bilgi) */
  .coords{
    position:fixed; right:8px; bottom:8px; background:#fff; border:1px solid var(--border);
    border-radius:10px; box-shadow:var(--shadow); padding:6px 10px; font-size:12px
  }
</style>
</head>
<body>

<script>
  /* ========================= AYARLAR =========================
     SVG_URL: Illustrator/Inkscape ile export ettiÄŸin SVG'nin web yoludur.
              Yerel C:\... yolu OLMAZ; repo iÃ§inde relative veya HTTPS olmalÄ±.
     GUEST_PANEL_URL: Misafir haritanÄ±n ana sayfasÄ± (derin link buraya yapÄ±lÄ±r). */
  const SVG_URL         = "https://markokara.github.io/leaflet-blue-dot/HARITA_INFO_EN_2025_RC_O6.svg";
  const GUEST_PANEL_URL = "https://markokara.github.io/leaflet-blue-dot/index.html";
</script>

<div id="stage">
  <!-- 1) PDFâ€™ten aldÄ±ÄŸÄ±n SVG burada gÃ¶sterilecek -->
  <object id="plan" type="image/svg+xml"></object>

  <!-- 2) EtkileÅŸim katmanÄ±: SVGâ€™nin ekran Ã§Ä±ktÄ±sÄ±na JS ile tam oturacak -->
  <div id="hit" title="ALT + tÄ±k ile yÃ¼zde koordinat al">
    <!-- 3) Ã–RNEK HOTSPOT: Olive -->
    <!-- left/top yÃ¼zdelerini ALT+tÄ±k ile Ã¶lÃ§ â†’ buraya yaz -->
    <button id="hot-olive" class="hot" style="left:66.5%; top:82%;">
      ğŸ½ï¸ Olive
      <small>Ä°ncele / Git</small>
    </button>
  </div>
</div>

<!-- Basit popup -->
<div id="m" class="modal"><div class="back" id="close"></div>
  <div class="card">
    <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
      <div style="font-weight:700;color:#0f5132">ğŸ½ï¸ Olive Ana Restoran</div>
      <button class="btn" id="close2">Kapat</button>
    </div>
    <div class="muted" style="margin:8px 0">BahÃ§e KatÄ± (âˆ’1) â€¢ KahvaltÄ± 06:30â€“10:00 â€¢ Ã–ÄŸle 12:30â€“15:00 â€¢ AkÅŸam 19:00â€“21:30</div>
    <div style="margin:6px 0">
      MenÃ¼: <a target="_blank" rel="noopener" href="https://www.regnumhotels.com/en/">regnumhotels.com</a>
    </div>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
      <!-- â€œÄ°nceleâ€ ayrÄ± sekmede aÃ§Ä±lÄ±r -->
      <a class="btn" target="_blank" rel="noopener" href="https://www.regnumhotels.com/en/">Ä°ncele</a>
      <!-- â€œGitâ€ misafir panelini derin link ile aÃ§ar -->
      <button class="btn" id="go">Git â†’ Haritada AÃ§</button>
    </div>
  </div>
</div>

<!-- ALT+tÄ±k koordinat yardÄ±m kutusu -->
<div class="coords">ALT + tÄ±k â†’ %: <b id="xy">â€“</b></div>

<script>
  /* ====== SVGâ€™yi yÃ¼kle ====== */
  const obj = document.getElementById('plan');
  obj.data = SVG_URL;

  /* ====== Derin link: Misafir panelinde ilgili FIDâ€™e git ======
     dest=fid:<id>  â†’  senin harita sayfand bu parametreyi okuyup
     hedefi seÃ§er ve autoGo/follow varsa hemen rota baÅŸlatÄ±r. */
  function goToGuest(fid){
    const u = new URL(GUEST_PANEL_URL);
    u.searchParams.set('dest','fid:'+fid);
    u.searchParams.set('autoGo','1');   // hemen rota hesapla
    u.searchParams.set('follow','1');   // konumu takip et (simÃ¼lasyon da olur)
    u.searchParams.set('lang','tr');    // opsiyonel
    location.href = u.toString();
  }

  /* ====== #hit katmanÄ±nÄ±, SVGâ€™nin gerÃ§ek Ã§izim alanÄ±na oturt ======
     (Ekran ile viewBox oranÄ± farklÄ± olduÄŸunda kenarlarda boÅŸluk oluÅŸur.
      AÅŸaÄŸÄ±daki hesap bu boÅŸluÄŸu tespit eder ve #hitâ€™i tam alana yerleÅŸtirir.) */
  function fitHitToSvg(){
    const hit  = document.getElementById('hit');
    const rect = obj.getBoundingClientRect();

    const svgDoc = obj.contentDocument; if(!svgDoc) return;
    const svgEl  = svgDoc.querySelector('svg'); if(!svgEl) return;

    // SVGâ€™nin orijinal oranÄ± (viewBox varsa buradan)
    const vb = svgEl.viewBox && svgEl.viewBox.baseVal;
    const svgW = vb && vb.width  ? vb.width  : (svgEl.width.baseVal?.value || rect.width);
    const svgH = vb && vb.height ? vb.height : (svgEl.height.baseVal?.value || rect.height);
    const aspectSvg = svgW / svgH;
    const aspectBox = rect.width / rect.height;

    let drawW=rect.width, drawH=rect.height, leftPad=0, topPad=0;
    if (aspectBox > aspectSvg){
      // ekran daha yatay â†’ yÃ¼kseklik belirleyici, yanlarda boÅŸluk olur
      drawH = rect.height;
      drawW = drawH * aspectSvg;
      leftPad = (rect.width - drawW)/2;
    } else {
      // ekran daha dikey â†’ geniÅŸlik belirleyici, Ã¼st/alt boÅŸluk olur
      drawW = rect.width;
      drawH = drawW / aspectSvg;
      topPad = (rect.height - drawH)/2;
    }

    // #hit tam alana otursun
    hit.style.left   = leftPad + 'px';
    hit.style.top    = topPad + 'px';
    hit.style.width  = drawW  + 'px';
    hit.style.height = drawH  + 'px';
  }

  /* ====== Olay baÄŸlama ====== */
  obj.addEventListener('load', ()=>{
    // #hitâ€™i yerine oturt
    fitHitToSvg();

    // Olive hotspot â†’ popup aÃ§
    document.getElementById('hot-olive').onclick = ()=>{
      document.getElementById('m').classList.add('on');
    };

    // Popup: Git
    document.getElementById('go').onclick     = ()=> goToGuest('gfl-olive-main-restaurant');
    // Popup: Kapat
    document.getElementById('close').onclick  = ()=> document.getElementById('m').classList.remove('on');
    document.getElementById('close2').onclick = ()=> document.getElementById('m').classList.remove('on');
  });

  // Pencere boyutu deÄŸiÅŸince #hit yeniden otursun
  window.addEventListener('resize', fitHitToSvg);

  /* ====== ALT + tÄ±k ile yÃ¼zdelik koordinat Ã¶lÃ§ (hotspot yerleÅŸtirmek iÃ§in) ======
     Ã–lÃ§tÃ¼ÄŸÃ¼n deÄŸeri hotspotâ€™un style="left:%; top:%" kÄ±smÄ±na yaz. */
  document.getElementById('hit').addEventListener('click', (e)=>{
    if(!e.altKey) return;
    const r = e.currentTarget.getBoundingClientRect();
    const x = ((e.clientX - r.left)/r.width)*100;
    const y = ((e.clientY - r.top )/r.height)*100;
    document.getElementById('xy').textContent = x.toFixed(1)+'% , '+y.toFixed(1)+'%';
    console.log('left:',x.toFixed(1)+'%','top:',y.toFixed(1)+'%');
  });

  /* ====== Yeni bir alan eklemek iÃ§in kÄ±sa not ======
     1) #hit iÃ§ine yeni bir <button class="hot" id="hot-XXX" style="left:..%; top:..%"> ekle.
     2) obj.addEventListener('load') iÃ§inde:
        document.getElementById('hot-XXX').onclick = ()=> document.getElementById('m').classList.add('on');
     3) â€œGitâ€ butonuna: () => goToGuest('FID-IN')
     4) Popup metnini istersen dinamik doldurabilirsin; basit kullanÄ±mda statik bÄ±rak. */
</script>
</body>
</html>
